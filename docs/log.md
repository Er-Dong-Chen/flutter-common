# æ—¥å¿—ç³»ç»Ÿ

## ğŸŒŸ ç‰¹æ€§

- ğŸ“ æ”¯æŒå¤šçº§åˆ«æ—¥å¿—
- ğŸ’¾ æ”¯æŒæ–‡ä»¶æ—¥å¿—
- ğŸ”„ æ”¯æŒæ—¥å¿—è½®è½¬
- ğŸ¯ æ”¯æŒæ—¥å¿—è¿‡æ»¤
- ğŸ”§ æ”¯æŒè‡ªå®šä¹‰è¾“å‡º
- ğŸ“± æ”¯æŒæ—¥å¿—ä¸ŠæŠ¥
- ğŸ›¡ï¸ æ”¯æŒæ—¥å¿—åŠ å¯†
- âš¡ æ”¯æŒæ€§èƒ½ç›‘æ§

## ğŸ”¥ æ ¸å¿ƒç‰¹æ€§è§£æ

### å››å±‚æ—¥å¿—æ¶æ„

| å±‚çº§           | æŠ€æœ¯å®ç°         | æ€§èƒ½æŒ‡æ ‡       |
| -------------- | ---------------- | -------------- |
| **å†…å­˜ç¼“å†²å±‚** | ç¯å½¢ç¼“å†²åŒºè®¾è®¡   | ç™¾ä¸‡çº§æ—¥å¿—/ç§’  |
| **éš”ç¦»å¤„ç†å±‚** | Dart Isolate     | é›¶ä¸»çº¿ç¨‹é˜»å¡   |
| **æŒä¹…åŒ–å±‚**   | æŒ‰æ—¥æœŸåˆ†æ–‡ä»¶å­˜å‚¨ | è‡ªåŠ¨æ»šåŠ¨å½’æ¡£   |
| **ä¼ è¾“å±‚**     | åŠ å¯†å‹ç¼©ä¼ è¾“     | TLS1.3+ AES256 |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åˆå§‹åŒ–é…ç½®

```dart
// è·å–åº”ç”¨æ–‡æ¡£ç›®å½•
Directory dir = await getApplicationDocumentsDirectory();

// åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿ
await Log.init(
  LogConfig(
    retentionDays: 3,           // æ—¥å¿—ä¿ç•™å¤©æ•°
    enableFileLog: true,        // å¯ç”¨æ–‡ä»¶æ—¥å¿—
    logLevel: LogLevel.all,     // æ—¥å¿—è¿‡æ»¤çº§åˆ«
    recordLevel: LogLevel.info, // æ—¥å¿—è®°å½•çº§åˆ«
    output: const [],           // è‡ªå®šä¹‰è¾“å‡º
    logDirectory: Directory('${dir.path}/logs'), // æ—¥å¿—ç›®å½•
  ),
);
```

### åŸºç¡€ä½¿ç”¨

```dart
// è°ƒè¯•æ—¥å¿—
Log.d("debug message");

// ä¿¡æ¯æ—¥å¿—
Log.i("info message");

// è­¦å‘Šæ—¥å¿—
Log.w("warning message");

// é”™è¯¯æ—¥å¿—
Log.e("error message", error: error, stackTrace: stackTrace);

// æ§åˆ¶å°æ—¥å¿—ï¼ˆæ— å‰ç¼€ã€æ‰“å°å®Œå…¨ã€æ–¹ä¾¿å¤åˆ¶ï¼‰
Log.console("console message");

// è·å–æ—¥å¿—ç›®å½•
final Directory dir = await Log.getLogDir();
```

## ğŸ¨ æ—¥å¿—é…ç½®

### æ—¥å¿—çº§åˆ«

```dart
enum LogLevel {
  verbose,  // è¯¦ç»†æ—¥å¿—
  debug,    // è°ƒè¯•æ—¥å¿—
  info,     // ä¿¡æ¯æ—¥å¿—
  warning,  // è­¦å‘Šæ—¥å¿—
  error,    // é”™è¯¯æ—¥å¿—
  none,     // ä¸æ˜¾ç¤ºæ—¥å¿—
  all,      // æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—
}
```

### æ—¥å¿—è¿‡æ»¤

```dart
LogConfig(
  logLevel: LogLevel.info,  // ä½äº info çº§åˆ«çš„æ—¥å¿—ä¸æ‰“å°
  recordLevel: LogLevel.warning,  // ä½äº warning çº§åˆ«çš„æ—¥å¿—ä¸å†™å…¥æ–‡ä»¶
)
```

## âš¡ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰è¾“å‡º

```dart
// è‡ªå®šä¹‰è¾“å‡ºæ’ä»¶
class SentryOutput extends LogOutput {
  @override
  void output(OutputEvent event) {
    if (event.level.value >= LogLevel.error.value) {
      Sentry.captureException(
        event.error,
        stackTrace: event.stackTrace,
        tags: {'log_level': event.level.name},
      );
    }
  }
}

// é…ç½®ä½¿ç”¨
Log.init(LogConfig(
  output: [SentryOutput()]
));
```

### æ—¥å¿—åŠ å¯†

```dart
// è‡ªå®šä¹‰åŠ å¯†è¾“å‡º
class EncryptedOutput extends LogOutput {
  @override
  void output(OutputEvent event) {
    final encrypted = encrypt(event.message);
    // å¤„ç†åŠ å¯†åçš„æ—¥å¿—
  }
}

// é…ç½®ä½¿ç”¨
Log.init(LogConfig(
  output: [EncryptedOutput()]
));
```

### æ€§èƒ½ç›‘æ§

```dart
// å¼€å§‹æ€§èƒ½ç›‘æ§
final stopwatch = Stopwatch()..start();

// æ‰§è¡Œæ“ä½œ
await someOperation();

// è®°å½•æ€§èƒ½æ—¥å¿—
Log.i(
  "Operation completed",
  tag: "Performance",
  extra: {
    "duration": stopwatch.elapsedMilliseconds,
    "operation": "someOperation",
  },
);
```

## ğŸ“š API å‚è€ƒ

### Log

| æ–¹æ³• | æè¿° |
|------|------|
| d() | è°ƒè¯•æ—¥å¿— |
| i() | ä¿¡æ¯æ—¥å¿— |
| w() | è­¦å‘Šæ—¥å¿— |
| e() | é”™è¯¯æ—¥å¿— |
| console() | æ§åˆ¶å°æ—¥å¿— |
| getLogDir() | è·å–æ—¥å¿—ç›®å½• |

### LogConfig

| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| retentionDays | int | æ—¥å¿—ä¿ç•™å¤©æ•° |
| enableFileLog | bool | æ˜¯å¦å¯ç”¨æ–‡ä»¶æ—¥å¿— |
| logLevel | LogLevel | æ—¥å¿—è¿‡æ»¤çº§åˆ« |
| recordLevel | LogLevel | æ—¥å¿—è®°å½•çº§åˆ« |
| output | List | è‡ªå®šä¹‰è¾“å‡ºåˆ—è¡¨ |
| logDirectory | Directory | æ—¥å¿—ç›®å½• |

### LogOutput

| æ–¹æ³• | æè¿° |
|------|------|
| output() | è¾“å‡ºæ—¥å¿— |

### OutputEvent

| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| level | LogLevel | æ—¥å¿—çº§åˆ« |
| message | String | æ—¥å¿—æ¶ˆæ¯ |
| error | dynamic | é”™è¯¯ä¿¡æ¯ |
| stackTrace | StackTrace? | å †æ ˆè·Ÿè¸ª |
| tag | String? | æ—¥å¿—æ ‡ç­¾ |
| extra | Map? | é¢å¤–ä¿¡æ¯ |
| time | DateTime | æ—¥å¿—æ—¶é—´ |

## ğŸ“ æ—¥å¿—æ ¼å¼

### æ§åˆ¶å°æ—¥å¿—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ #0   Log.i (package:flutter_chen_common/log/logger.dart:112:46)
â”‚ #1   main (package:example/main.dart:53:7)
â”œâ”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„
â”‚ ğŸ’¡ info message
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ #0   Log.w (package:flutter_chen_common/log/logger.dart:113:46)
â”‚ #1   main (package:example/main.dart:54:7)
â”œâ”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„
â”‚ âš ï¸ warning message
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ #0   Log.e (package:flutter_chen_common/log/logger.dart:115:16)
â”‚ #1   main (package:example/main.dart:55:7)
â”œâ”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„
â”‚ â›” error message
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ âœ… [HTTP] 2025-04-05 23:30:29 Request sent [Duration] 88ms
â”‚ Request: 200 GET http://www.weather.com.cn/data/sk/101010100.html?xxxx=xxxx
â”‚ Headers: {"token":"xxxxx","content-type":"application/json"}
â”‚ Query: {"xxxx":"xxxx"}
â”‚ Response: {"weatherinfo":{"city":"åŒ—äº¬","cityid":"101010100","WD":"ä¸œå—é£"}}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

## ğŸ”§ æœ€ä½³å®è·µ

1. åˆç†ä½¿ç”¨æ—¥å¿—çº§åˆ«
2. é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²
3. å®šæœŸæ¸…ç†æ—¥å¿—æ–‡ä»¶
4. ä½¿ç”¨æ ‡ç­¾åˆ†ç±»æ—¥å¿—
5. æ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯
6. ç›‘æ§æ—¥å¿—æ–‡ä»¶å¤§å°
7. å®ç°æ—¥å¿—è½®è½¬
8. é…ç½®æ—¥å¿—ä¸ŠæŠ¥ 